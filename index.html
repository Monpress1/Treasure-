<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Path Forward | A Love Letter</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;400;700&family=Playfair+Display:ital,wght@0,400;1,700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #050505;
            --card-bg: rgba(15, 15, 20, 0.6);
            --accent: #bb86fc; 
            --gold: #ffd700;
            --text-main: #e0e0e0;
            --text-dim: #cccccc;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg);
            height: 100vh; width: 100vw;
            overflow: hidden; color: var(--text-main);
            touch-action: none;
        }

        #bg-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;
        }

        .app-interface {
            position: relative; z-index: 10;
            height: 100%; width: 100%;
            display: flex; flex-direction: column;
            pointer-events: none; 
        }

        .slide {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: 30px; opacity: 0; visibility: hidden;
            text-align: center; transition: transform 0.8s ease;
        }

        .slide.active { opacity: 1; visibility: visible; }

        .glass-panel {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 35px;
            padding: 40px 25px;
            width: 100%; max-width: 420px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            position: relative;
            pointer-events: none;
        }

        .glass-panel button { pointer-events: auto; }

        h1 { 
            font-family: 'Playfair Display', serif; 
            font-size: 2rem; font-weight: 700; font-style: italic;
            margin-bottom: 15px; color: var(--accent);
            text-shadow: 0 0 20px rgba(187, 134, 252, 0.3);
        }

        p { font-size: 1rem; line-height: 1.7; font-weight: 400; margin-bottom: 25px; color: var(--text-dim); }

        .btn-action {
            background: linear-gradient(135deg, #6200ee, #bb86fc);
            border: none; padding: 15px 40px; border-radius: 50px;
            color: white; cursor: pointer; font-size: 0.9rem;
            font-weight: 700; letter-spacing: 1px;
            box-shadow: 0 10px 20px rgba(98, 0, 238, 0.3);
            transition: 0.3s ease;
            display: inline-flex; align-items: center; gap: 10px;
        }
        .btn-action:active { transform: scale(0.95); }

        .btn-outline {
            background: rgba(0,0,0,0.3); border: 1px solid var(--accent);
            color: var(--accent); padding: 12px 30px; border-radius: 50px;
            cursor: pointer; font-weight: 600; margin-top: 10px;
            transition: 0.3s;
        }

        .icon-box {
            font-size: 2.5rem; color: var(--gold); margin-bottom: 20px;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.4));
        }

        #hud {
            position: absolute; bottom: 40px; width: 100%; text-align: center;
            color: var(--accent); font-size: 0.8rem; letter-spacing: 3px;
            text-transform: uppercase; pointer-events: none; opacity: 0.6;
            animation: pulse 2s infinite;
        }

        @keyframes pulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.8; } }
        
        .together-btn { background: linear-gradient(135deg, #11998e, #38ef7d) !important; box-shadow: 0 10px 20px rgba(56, 239, 125, 0.3) !important; }

        #final-message {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 100;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; visibility: hidden; pointer-events: none;
            transition: all 1s ease;
        }
        #final-message.visible { opacity: 1; visibility: visible; pointer-events: auto; }
        
        .message-card {
            background: #1a1a1a; padding: 40px; border-radius: 20px;
            border: 1px solid var(--gold); text-align: center;
            max-width: 90%; transform: scale(0.8); transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #final-message.visible .message-card { transform: scale(1); }
        .heart-pulse { color: #ff4d4d; font-size: 3rem; animation: heartbeat 1.5s infinite; margin-bottom: 20px; }
        @keyframes heartbeat { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <canvas id="bg-canvas"></canvas>

    <div id="final-message">
        <div class="message-card">
            <div class="heart-pulse"><i class="fa-solid fa-heart"></i></div>
            <h2 style="font-family: 'Playfair Display'; color: white; margin-bottom: 15px;">I Love You</h2>
            <p style="color: #ccc;">Thank You Babe.<br>Let's make this ride smooth, together üòò.</p>
            <button class="btn-action" onclick="location.reload()">Replay</button>
        </div>
    </div>

    <div class="app-interface">
        <div class="slide active" id="slide1">
            <div class="glass-panel">
                <div class="icon-box"><i class="fa-solid fa-envelope-open-text"></i></div>
                <h1>A Love Letter</h1>
                <p>This isn't just a message. It's a space I built for us. From this moment on, I want us to choose peace over pride and love over friction.</p>
                <button class="btn-action" onclick="toSlide(2)">Begin Our Journey <i class="fa-solid fa-arrow-right"></i></button>
            </div>
        </div>

        <div class="slide" id="slide2">
            <div class="glass-panel">
                <div class="icon-box"><i class="fa-solid fa-wind"></i></div>
                <h1>The Silk Ribbon</h1>
                <p>Our connection is a thread. Sometimes it tangles, but it never breaks. Guide the ribbon with your heart.</p>
                <button class="btn-outline" onclick="toSlide(3)">Continue</button>
            </div>
            <div id="hud">Move your finger to guide</div>
        </div>

        <div class="slide" id="slide3">
            <div class="glass-panel">
                <div class="icon-box"><i class="fa-solid fa-droplet"></i></div>
                <h1>The Wishing Well</h1>
                <p>Every ripple you create clears the surface of our history. Let the arguments sink into the deep dark water.</p>
                <button class="btn-outline" onclick="toSlide(4)">Release Tension</button>
            </div>
            <div id="hud">Tap the water</div>
        </div>

        <div class="slide" id="slide4">
            <div class="glass-panel">
                <div class="icon-box"><i class="fa-solid fa-leaf"></i></div>
                <h1>Raking the Path</h1>
                <p>I wish for a smoother ride for us. Help me draw a new trail in the sand, where every step is softer than the last.</p>
                <button class="btn-outline" onclick="toSlide(5)">Design Our Future</button>
            </div>
            <div id="hud">Draw on the sand</div>
        </div>

        <div class="slide" id="slide5">
          <br><br><br><hr>  <div class="glass-panel">
                <div class="icon-box"><i class="fa-solid fa-gem"></i></div>
                <h1>The Crystal Forge</h1>
                <p>We are like this crystal‚Äîstrong but fractured. <strong>Hold down</strong> on the screen to warm the glass and heal the cracks.</p>
                <button class="btn-outline" onclick="toSlide(6)">Heal Us</button>
            </div>
            <div id="hud">Hold screen to Forge</div>
        </div>

        <div class="slide" id="slide6">
            <div class="glass-panel">
                <div class="icon-box"><i class="fa-solid fa-fire-glow"></i></div>
                <h1>Our Intentions</h1>
                <p>Less arguing, more loving. Release these lights to the universe as a promise to try harder, together.</p>
                <button class="btn-outline" onclick="toSlide(7)">Last One...</button>
            </div>
            <div id="hud">Tap lights to release</div>
        </div>

        <div class="slide" id="slide7">
            <div class="glass-panel">
                <div class="icon-box"><i class="fa-solid fa-hands-holding-heart"></i></div>
                <h1>A Smoother Ride</h1>
                <p>I want us to work on ourselves together. No more "me vs you," just "us vs the problem."<br><br><strong>Can you do that for me?</strong></p>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <button class="btn-action together-btn" onclick="finalPromise()"><i class="fa-solid fa-handshake-angle"></i> Let's do it together</button>
                    <button class="btn-outline" onclick="finalPromise()"><i class="fa-solid fa-heart"></i> I promise</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * 1. this code was made by Eli Monpress jan 23, 2026, you can take apart the code to build something else, you are free to do so, anyways, I have used few js libraries, mostly three.js.
         
         {{{{ü§ôüéâcontact me on 07077575301 WA for more infoüéâ}}}}
         */
        let scene, camera, renderer, mouse, raycaster;
        let currentSceneObjects = [];
        let activeSlide = 1;
        let clock = new THREE.Clock();
        let isHolding = false;

        function initCore() {
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x050505, 0.15);
            
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            renderer = new THREE.WebGLRenderer({ 
                canvas: document.getElementById('bg-canvas'), 
                antialias: true, 
                alpha: true 
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

            mouse = new THREE.Vector2(0, 0);
            raycaster = new THREE.Raycaster(); // Added Raycaster for accuracy

            const ambient = new THREE.AmbientLight(0x404040, 2); 
            scene.add(ambient);
            
            const pointLight = new THREE.PointLight(0xbb86fc, 2, 50);
            pointLight.position.set(5, 5, 5);
            scene.add(pointLight);

            // This will handle all the inputs ü§ß please don't change this part of, was the hardest to get ü•∫ü•∫,
            
            window.addEventListener('resize', onResize);
            window.addEventListener('mousemove', (e) => {
                updateMouse(e.clientX, e.clientY);
            });
            window.addEventListener('mousedown', () => { isHolding = true; triggerInteraction(); });
            window.addEventListener('mouseup', () => { isHolding = false; });

            window.addEventListener('touchstart', (e) => {
                isHolding = true;
                updateMouse(e.touches[0].clientX, e.touches[0].clientY);
                triggerInteraction();
            }, {passive: false});
            
            window.addEventListener('touchmove', (e) => {
                e.preventDefault(); 
                updateMouse(e.touches[0].clientX, e.touches[0].clientY);
            }, {passive: false});

            window.addEventListener('touchend', () => { isHolding = false; });

            animate();
            createStars();
        }

        function clearScene() {
            currentSceneObjects.forEach(obj => scene.remove(obj));
            currentSceneObjects = [];
        }

        /* --- SCENE OBJECTS --- */

        function createStars() {
            const geo = new THREE.BufferGeometry();
            const count = 1500;
            const pos = new Float32Array(count * 3);
            for(let i=0; i<count*3; i++) pos[i] = (Math.random() - 0.5) * 40;
            geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
            const mat = new THREE.PointsMaterial({ size: 0.05, color: 0xbb86fc, transparent: true, opacity: 0.4 });
            const stars = new THREE.Points(geo, mat);
            scene.add(stars);
        }

        let ribbonMesh;
        function initRibbon() {
            clearScene();
            const curve = new THREE.CatmullRomCurve3([
                new THREE.Vector3(-4, 0, 0),
                new THREE.Vector3(-2, 2, -1),
                new THREE.Vector3(0, 0, 0),
                new THREE.Vector3(2, -2, 1),
                new THREE.Vector3(4, 0, 0)
            ]);
            const tubeGeo = new THREE.TubeGeometry(curve, 100, 0.08, 8, false);
            const tubeMat = new THREE.MeshStandardMaterial({ color: 0xbb86fc, emissive: 0x6200ee, roughness: 0.3, metalness: 0.8 });
            ribbonMesh = new THREE.Mesh(tubeGeo, tubeMat);
            scene.add(ribbonMesh);
            currentSceneObjects.push(ribbonMesh);
        }

        let waterPlane;
        function initWell() {
            clearScene();
            const geo = new THREE.CircleGeometry(5, 64);
            const mat = new THREE.MeshPhysicalMaterial({ color: 0x1a1a2e, metalness: 0.9, roughness: 0.1, transmission: 0.5, transparent: true, opacity: 0.6});
            waterPlane = new THREE.Mesh(geo, mat);
            waterPlane.rotation.x = -Math.PI / 2.5;
            waterPlane.position.y = -1;
            scene.add(waterPlane);
            currentSceneObjects.push(waterPlane);
        }

        let sandPoints;
        let originalSandPos;
        function initSand() {
            clearScene();
            const count = 80000;
            const geo = new THREE.BufferGeometry();
            const pos = new Float32Array(count * 3);
            originalSandPos = new Float32Array(count * 3);
            
            for(let i=0; i<count; i++) {
                let x = (Math.random() - 0.5) * 12;
                let y = (Math.random() - 0.5) * 8;
                let z = 0;
                
                pos[i*3] = x;
                pos[i*3+1] = y;
                pos[i*3+2] = z;

                originalSandPos[i*3] = x;
                originalSandPos[i*3+1] = y;
                originalSandPos[i*3+2] = z;
            }
            
            geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
            const mat = new THREE.PointsMaterial({ color: 0xbb86fc, size: 0.03 });
            sandPoints = new THREE.Points(geo, mat);
            sandPoints.rotation.x = -Math.PI / 7;
            
            scene.add(sandPoints);
            currentSceneObjects.push(sandPoints);
        }

        let mainCrystal, cracks;
        function initCrystal() {
            clearScene();
            const geo = new THREE.OctahedronGeometry(1.8, 0);
            const mat = new THREE.MeshPhysicalMaterial({ color: 0xbb86fc, emissive: 0x220033, transmission: 0.8, thickness: 2, roughness: 0 });
            mainCrystal = new THREE.Mesh(geo, mat);
            
            const wireGeo = new THREE.OctahedronGeometry(1.82, 1);
            const wireMat = new THREE.MeshBasicMaterial({ color: 0xff0000, wireframe: true, transparent: true, opacity: 0.8 });
            cracks = new THREE.Mesh(wireGeo, wireMat);
            
            const group = new THREE.Group();
            group.add(mainCrystal);
            group.add(cracks);
            scene.add(group);
            currentSceneObjects.push(group);
        }

        let lanterns = [];
        function initLanterns() {
            clearScene();
            for(let i=0; i<15; i++) {
                const geo = new THREE.CylinderGeometry(0.2, 0.15, 0.4, 6);
                const mat = new THREE.MeshStandardMaterial({ color: 0xffd700, emissive: 0xffa500, emissiveIntensity: 2 });
                const l = new THREE.Mesh(geo, mat);
                l.position.set((Math.random()-0.5)*12, -4 - (Math.random()*6), (Math.random()-0.5)*5);
                scene.add(l);
                lanterns.push(l);
                currentSceneObjects.push(l);
            }
        }

        /* --- LOGIC --- */

        function toSlide(n) {
            const current = document.querySelector(`.slide#slide${activeSlide}`);
            const next = document.querySelector(`.slide#slide${n}`);

            gsap.to(current, { opacity: 0, scale: 0.9, duration: 0.6, onComplete: () => {
                current.classList.remove('active');
                next.classList.add('active');
                gsap.fromTo(next, { opacity: 0, scale: 1.1 }, { opacity: 1, scale: 1, duration: 0.8 });
                activeSlide = n;
                
                if(n === 2) initRibbon();
                if(n === 3) initWell();
                if(n === 4) initSand();
                if(n === 5) initCrystal();
                if(n === 6) initLanterns();
                if(n === 7) gsap.to(camera.position, { z: 8, duration: 2 });
            }});
        }

        function updateMouse(x, y) {
            mouse.x = (x / window.innerWidth) * 2 - 1;
            mouse.y = -(y / window.innerHeight) * 2 + 1;
        }

        function triggerInteraction() {
            // üí™ DIS IS Ripple Effect (Slide 3) -  USING RAYCASTING, 
            if(activeSlide === 3 && waterPlane) {
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObject(waterPlane);

                if (intersects.length > 0) {
                    const point = intersects[0].point;
                    const ring = new THREE.Mesh(
                        new THREE.TorusGeometry(0.1, 0.02, 16, 100),
                        new THREE.MeshBasicMaterial({ color: 0xffd700, transparent: true })
                    );
                    
                    // Set rotation and exact hit position
                    ring.rotation.x = -Math.PI / 2.5;
                    ring.position.copy(point);
                    
                    scene.add(ring);
                    gsap.to(ring.scale, { x: 30, y: 30, duration: 2 });
                    gsap.to(ring.material, { opacity: 0, duration: 2, onComplete: () => scene.remove(ring) });
                }
            }

            // (please feel free to improve this one,  I feel like there's something I could have done differently but I was just feeling lazy ü¶•)Lantern floating release(Slide 6)
            
            if(activeSlide === 6) {
                lanterns.forEach((l, i) => {
                    gsap.to(l.position, { 
                        y: 10, 
                        x: l.position.x + (Math.random()-0.5)*3, 
                        duration: 5 + Math.random()*5, 
                        delay: i * 0.05 
                    });
                });
            }
        }

        function finalPromise() {
            confetti({
                particleCount: 200,
                spread: 100,
                origin: { y: 0.6 },
                colors: ['#bb86fc', '#ffd700', '#ffffff']
            });
            document.getElementById('final-message').classList.add('visible');
        }

        function onResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            let t = clock.getElapsedTime();
            
            // 1. RIBBON üéóÔ∏è balloon
            if(activeSlide === 2 && ribbonMesh) {
                ribbonMesh.rotation.y += (mouse.x * 1.5 - ribbonMesh.rotation.y) * 0.05;
                ribbonMesh.rotation.x += (-mouse.y * 1.5 - ribbonMesh.rotation.x) * 0.05;
                ribbonMesh.rotation.z += 0.005;
            }

            // 2. SAND RAKING
            if(activeSlide === 4 && sandPoints) {
                const positions = sandPoints.geometry.attributes.position.array;
                const interactX = mouse.x * 6; 
                const interactY = mouse.y * 4; 

                for(let i=0; i<positions.length/3; i++) {
                    let px = positions[i*3];
                    let py = positions[i*3+1];
                    let ox = originalSandPos[i*3];
                    let oy = originalSandPos[i*3+1];

                    let dx = interactX - px;
                    let dy = interactY - py;
                    let dist = Math.sqrt(dx*dx + dy*dy);

                    if(dist < 1.5) {
                        let angle = Math.atan2(dy, dx);
                        positions[i*3] -= Math.cos(angle) * 0.15;
                        positions[i*3+1] -= Math.sin(angle) * 0.15;
                    } else {
                        positions[i*3] += (ox - px) * 0.02;
                        positions[i*3+1] += (oy - py) * 0.02;
                    }
                }
                sandPoints.geometry.attributes.position.needsUpdate = true;
            }

            // 3. CRYSTAL HEALING (try improving the visuals by adding actual cracks if you can)
            if(activeSlide === 5 && cracks && mainCrystal) {
                mainCrystal.rotation.y += 0.005;
                cracks.rotation.y += 0.005;

                if(isHolding) {
                    cracks.material.opacity = THREE.MathUtils.lerp(cracks.material.opacity, 0, 0.05);
                    mainCrystal.material.emissiveIntensity = THREE.MathUtils.lerp(mainCrystal.material.emissiveIntensity, 4, 0.1);
                    mainCrystal.position.x = (Math.random() - 0.5) * 0.05; // Shake
                } else {
                    cracks.material.opacity = THREE.MathUtils.lerp(cracks.material.opacity, 0.8, 0.02);
                    mainCrystal.material.emissiveIntensity = THREE.MathUtils.lerp(mainCrystal.material.emissiveIntensity, 0.5, 0.05);
                    mainCrystal.position.x = 0;
                }
            }

            if(waterPlane) waterPlane.position.y = -1 + Math.sin(t) * 0.05;

            renderer.render(scene, camera);
        }

        initCore();
    </script>
</body>
</html>
